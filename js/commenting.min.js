(function(a){a(document).ready(function(){window.addComment={interval:0,replying:0,action_id:0,showOne:commentingL10n.rpl_show_1.replace("%name%",'<span class="poster-name"></span>').replace("%count%",'<span class="post-count">&nbsp;</span>'),hideOne:commentingL10n.rpl_hide_1.replace("%name%",'<span class="poster-name"></span>').replace("%count%",'<span class="post-count">&nbsp;</span>'),showMany:commentingL10n.rpl_show_2.replace("%name%",'<span class="poster-name"></span>').replace("%count%",'<span class="post-count">&nbsp;</span>'),
hideMany:commentingL10n.rpl_hide_2.replace("%name%",'<span class="poster-name"></span>').replace("%count%",'<span class="post-count">&nbsp;</span>'),moveForm:function(c,b){var d=a("#"+c+" > .comment-body .comment-meta").next().text(),f=a("#"+c+" > .comment-body cite.fn").text();addComment.replying&&addComment.cancelReply();addComment.replying=b;a("#comment-form #comment").before(a('<blockquote class="reply-quote"><cite>'+f+"</cite><p>"+(130<d.length?d.substring(0,129)+"&hellip;":d)+"</p></blockquote>").hide()).prev(".reply-quote").slideDown();
a("#comment-form input#comment_parent").attr({value:b});a("#"+c+" > .comment-body ").find(".comment-reply-link").hide();a("#comment-form #cancel-comment-reply-link").show();"function"==typeof a.scrollTo&&a.scrollTo("#respond",{duration:500,axis:"y",onAfter:function(){a("#comment").focus()}});return!1},cancelReply:function(){0!==addComment.replying&&(addComment.replying=0,a("#comment-form .reply-quote").slideUp(500,function(){a(this).remove()}),a("#comment-form input#comment_parent").attr({value:0}),
a("#comment-form #cancel-comment-reply-link").hide(),a("#commentlist").find(".comment-reply-link").show());a("#comment-form .submit").removeAttr("disabled").removeClass("disabled");addComment.startInterval(!0)},commentDepth:function(c){return c?(c=a("li#comment-"+c).attr("class").match(/\bdepth-(\d+)\b/i),0<parseInt(c[1],10)?parseInt(c[1],10):1):0},error:function(c){if("string"!==typeof c)return!1;a("#comment-form .textarea-border").after(a('<div class="error">'+c+"</div>").hide()).next(".error").slideDown("slow",
function(){var c=a(this);void 0!==a(this)[0].style&&(a(this).css("FILTER",""),a(this)[0].style.filter="");setTimeout(function(){a(c).slideUp("slow",function(){a(this).remove()})},5E3)});return!0},deleteComment:function(c,b){if(!a("ul#commentlist li#comment-"+c+", #trackback-list li#comment-"+c).length||"unapprove"==b&&a("ul#commentlist li#comment-"+c+" > .comment-body:has( .moderation )"))return!0;a("li#comment-"+c+" > .comment-body").slideUp("slow",function(){a(this).text("Deleted comment").slideDown().parent("li#comment-"+
c).addClass("deleted")});return!0},newComment:function(c,b,d,f,e){if(a("ul#commentlist li#comment-"+b+", #trackback-list li#comment-"+b).length)return a("ul#commentlist li#comment-"+b).find(".moderation").slideUp("slow",function(){a(this).remove()}),a("li#comment-"+b).hasClass("deleted")&&a("li#comment-"+b+" > .comment-body").slideUp("slow",function(){a(this).html(a(c).find(".comment-body").html().trigger("newComment")).slideDown("slow")}).removeClass("deleted"),!0;"comment"==e&&0<d?a("ul#commentlist li#comment-"+
d).length&&(a("ul#commentlist li#comment-"+d+" > ul.children").length||a("ul#commentlist li#comment-"+d+" > div.comment-body").after('<ul class="children"></ul>'),a("ul#commentlist li#comment-"+d+" > ul.children").append(a(c).hide().addClass("rolledup").trigger("newComment")),d=a("li#comment-"+d).attr("class").match(/(?:\s|^)depth-(\d+)\s?/i),null!==d[1]&&d[1].match(/\d+/)&&(a("ul#commentlist li#comment-"+b).removeClass("depth-1 depth-2 depth-3 depth-4 depth-5 depth-6 depth-7 depth-8 depth-9 depth-10").addClass("depth-"+
(parseInt(d[1],10)+1)),parseInt(d[1],10)+1>=commentingL10n.max_depth&&a("ul#commentlist li#comment-"+b+" > div.comment-body .comment-reply-link").remove()),a("#comment-"+b).closest("li:has(div.toggle)").children(".toggle").hasClass("hidden")&&a("#comment-"+b).closest("li:has(div.toggle)").children(".toggle").removeClass("hidden").next("ul.children").slideDown("fast",function(){a(this).prev("div.toggle").css({backgroundPosition:"bottom right"})}),addComment.toggleToggleText(a("#comment-"+b).closest("li:has(div.toggle)").children(".toggle")),
addComment.addToggles()):("comment"!==e&&a("#trackback-list").length?a("#trackback-list").append(a(c).hide().addClass("rolledup").trigger("newComment")):"desc"===commentingL10n.order?a("li#response-cont").after(a(c).hide().addClass("rolledup").trigger("newComment")):a("li#response-cont").before(a(c).hide().addClass("rolledup").trigger("newComment")),addComment.addToggles());f||(a("#comment-"+b).addClass("new").children("#div-comment-"+b).find(".comment-meta").prepend('<span class="new-comment"></span>'),
a("#div-comment-"+b).bind("mouseover",function(){a(this).find(".comment-meta span.new-comment").fadeTo(1E3,0,function(){a(this).closest("li").removeClass("new");a(this).remove()})}));a("ul#commentlist, ul#trackback-list").find(".rolledup").slideDown(500,function(){f&&a.scrollTo("#comment-"+b,{duration:500,axis:"y"})}).removeClass("rolledup");"comment"!==e&&addComment.trackbackToggle(400);return!0},submit:function(c){var b=!1;a(c).find(".vital").each(function(){var d=a(this).attr("value");void 0===
d||""===d?(b=!0,a(this).addClass("oops"),setTimeout(function(){a("#comment-form .vital").removeClass("oops")},6E3)):a(this).removeClass("oops")});if(b)return addComment.error(commentingL10n.err_txt_mis),!1;addComment.startInterval(!1);a(c).ajaxSubmit({beforeSubmit:function(){a("#comment-form .submit").attr({disabled:"disabled"}).addClass("disabled")},type:"POST",data:{_spec_ajax:"Why are you looking at this POST data?",action:"new_comment_added",depth:addComment.commentDepth(addComment.replying)},
error:function(d,c){var b;if(500===d.status){b=a(d.responseText).text().replace(/(\s+|\t|\r\n|\n|\r)+/g," ");if(""===b||void 0===b)b=d.status+" "+d.statusText;addComment.error(b)}else"string"===typeof c?addComment.error(c):addComment.error("Oops!");addComment.cancelReply()},success:function(c){var b;try{b=JSON.parse(c)}catch(e){"string"===typeof c?addComment.error(c):addComment.error("Oops!");addComment.cancelReply();return}addComment.newComment(b.html,b.comment_ID,b.comment_parent,!0,"comment");
addComment.cancelReply();a("#comment-form #comment").val("").trigger("keyup")}});return!1},addToggles:function(c){a("#commentlist li.depth-"+commentingL10n.nest_depth+" > ul.children").each(function(){a(this).prev("div.toggle").length||(a(this).before(a('<div class="toggle"></div>').hide().css({opacity:0})),a(this).prev("div.toggle").show().fadeTo("slow",1,function(){void 0!==a(this)[0].style&&(a(this).css("FILTER",""),a(this)[0].style.filter="")}));!0===c&&a(this).hide().prev("div.toggle").addClass("kqofn-hidden");
addComment.toggleToggleText(a(this).prev("div.toggle"))})},toggleToggleText:function(c){"object"!==typeof c&&"string"===typeof c&&(c=a(c));c.each(function(){var c=a(this).prev("div.comment-body").find("cite.fn").text(),d=a(this).next("ul.children").find("li.comment").length;a(this).hasClass("kqofn-hidden")?a(this).html(1==d?addComment.showOne:addComment.showMany):a(this).html(1==d?addComment.hideOne:addComment.hideMany);a(this).find(".post-count").text(d);a(this).find(".poster-name").text(""!=c?c:
commentingL10n.unknown)});return!0},startInterval:function(a){!0===a?void 0!==commentingL10n.update&&1==commentingL10n.update&&(addComment.interval=setInterval(function(){addComment.getUpdates()},10<=parseInt(commentingL10n.polling,10)?1E3*commentingL10n.polling:1E4)):clearInterval(addComment.interval)},getUpdates:function(){addComment.getCommentUpdates()},getCommentUpdates:function(){a.post(commentingL10n.ajax_url,{_spec_ajax:"Why is everyone looking at me",action:"get_comment_changes",action_id:addComment.action_id,
time:commentingL10n.time,post_id:commentingL10n.post_id},function(a){var b,d;try{b=JSON.parse(a)}catch(f){"string"===typeof a?addComment.error(a):addComment.error("Oops!");return}if(null!==b&&void 0!==b)for(d in b)comment=b[d],void 0!==comment&&(a=null!==comment.log_date?comment.log_date:comment.comment_date,null!==a&&(commentingL10n.time=a),addComment.action_id=null!==comment.action_id?comment.action_id:0,void 0!==comment.html&&null!==b[d].html&&""!==comment.html?addComment.newComment(comment.html,
comment.comment_ID,comment.comment_parent,!1,comment.comment_type):addComment.deleteComment(comment.comment_ID,comment.action))})},getModerationUpdates:function(){a.post(commentingL10n.ajax_url,{_spec_ajax:"Why is everyone looking at me",action:"get_moderation_changes",action_id:addComment.action_id,time:commentingL10n.time,post_id:commentingL10n.post_id},function(a){var b,d;try{b=JSON.parse(a)}catch(f){"string"===typeof a?addComment.error(a):addComment.error("Oops!");return}if(null!==b&&void 0!==
b)for(d in b)if(a=b[d],void 0!==a){var e=null!==a.log_date?a.log_date:a.comment_date;null!==e&&(commentingL10n.time=e);addComment.action_id=null!==a.action_id?a.action_id:0;void 0!==a.html&&(null!==a.html&&""!==a.html)&&addComment.newComment(a.html,a.comment_ID,a.comment_parent,!1,a.comment_type)}})},trackbackToggle:function(c){a("#trackback-list").height()>(0<c?c:400)&&(!a("#trackback-list").prev(".trackback-toggle").length&&a("#trackback-list").length)&&a("#trackback-list").hide().before('<div class="trackback-toggle"><span class="toggle-text">'+
commentingL10n.tb_show+"</span></div>").prev(".trackback-toggle").click(function(){a(this).toggleClass("active").next("#trackback-list").slideToggle("fast",function(){a(this).prev(".trackback-toggle").children(".toggle-text").text("none"===a(this).css("display")?commentingL10n.tb_show:commentingL10n.tb_hide)})});a("#commentlist li.pingback > .comment-body .comment-content, #commentlist li.trackback > .comment-body .comment-content").each(function(){if(a(this).prev(".trackback-toggle").length)return!0;
var b=commentingL10n.tb_from.replace("%s",'<span class="tb-from">'+a(this).find("cite.fn").text()+"</span>");a(this).hide().addClass("with-toggle").before('<div class="trackback-toggle"></div>').prev(".trackback-toggle").html(b).click(function(){a(this).next(".comment-content").slideToggle("fast")});return!0})},approveComment:function(c,b){a.post(commentingL10n.ajax_url,{_spec_ajax:"Why is everyone looking at me",action:"approve_comment",action_id:addComment.action_id,time:commentingL10n.time,post_id:commentingL10n.post_id,
comment_id:b},function(a){"done"==a?(c.text("Approval sent, verifying..."),addComment.getCommentUpdates()):addComment.error(a)})},spamComment:function(c,b){a.post(commentingL10n.ajax_url,{_spec_ajax:"Why is everyone looking at me",action:"spam_comment",action_id:addComment.action_id,time:commentingL10n.time,post_id:commentingL10n.post_id,comment_id:b},function(a){"done"==a?(c.text("Spam req sent, verifying..."),addComment.getCommentUpdates()):addComment.error(a)})},trashComment:function(c,b){a.post(commentingL10n.ajax_url,
{_spec_ajax:"Why is everyone looking at me",action:"delete_comment",action_id:addComment.action_id,time:commentingL10n.time,post_id:commentingL10n.post_id,comment_id:b},function(a){"done"==a?(c.text("Deletion sent, verifying..."),addComment.getCommentUpdates()):addComment.error(a)})},_init:function(){var c=a("form#comment-form"),b=a("#commentlist");a(document).ready(function(a){addComment.startInterval(!0);a.ajaxSetup({cache:!1,timeout:1E3*commentingL10n.polling-2E3});c.submit(function(){addComment.submit(this);
return!1});c.on("click","#cancel-comment-reply-link",function(){addComment.cancelReply();return!1});b.on("click",".spec_moderation_button_approve",function(){var b=a(this).attr("data-comment");addComment.approveComment(a(this),b);return!1});b.on("click",".spec_moderation_button_spam",function(){var b=a(this).attr("data-comment");addComment.spamComment(a(this),b);return!1});b.on("click",".spec_moderation_button_delete",function(){var b=a(this).attr("data-comment");addComment.trashComment(a(this),b);
return!1});addComment.addToggles(!0);b.on("click","div.toggle",function(){a(this).hasClass("kqofn-hidden")?a(this).removeClass("kqofn-hidden").next("ul.children").slideDown("fast",function(){a(this).prev("div.toggle").css({backgroundPosition:"bottom right"})}):a(this).addClass("kqofn-hidden").next("ul.children").slideUp("fast",function(){a(this).prev("div.toggle").css({backgroundPosition:"top left"})});addComment.toggleToggleText(a(this))});addComment.trackbackToggle(400);b.on("click",".comment-link",
function(){var b=a(this).attr("href"),c=a(this).text(),b=a('<div class="comment-link-display"><span>'+c+'</span><input type="text" value="'+b+'" /></div>');a("body").append(b).find(".comment-link-display").css({position:"absolute",top:a(this).offset().top-27+"px",left:a(this).offset().left+5+"px",zIndex:100,opacity:0}).fadeTo("fast",1,function(){a(this).find("input").blur(function(){a(this).parents(".comment-link-display").fadeTo("fast",0,function(){a(this).remove()})});a(this).find("input").focus()});
return!1});b.find(".comment-link-display").on("focus","input",function(){this.select()});a.each(a.browser,function(b,c){if("msie"==b&&!0===c)switch(parseInt(a.browser.version.substr(0,1),10)){case 6:case 7:for($target=a("#comment");"inherit"==$target.css("fontFamily");)$target=$target.parent();a("#comment").css({fontFamily:$target.css("fontFamily"),fontSize:$target.css("fontSize"),width:a("#comment").innerWidth()})}});a("#comment").autogrow()})}};addComment._init()})})(jQuery);
//# sourceMappingURL=commenting.min.js.map
