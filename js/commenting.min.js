addComment={interval:0,replying:0,action_id:0,showOne:commentingL10n.rpl_show_1.replace("%name%",'<span class="poster-name"></span>').replace("%count%",'<span class="post-count">&nbsp;</span>'),hideOne:commentingL10n.rpl_hide_1.replace("%name%",'<span class="poster-name"></span>').replace("%count%",'<span class="post-count">&nbsp;</span>'),showMany:commentingL10n.rpl_show_2.replace("%name%",'<span class="poster-name"></span>').replace("%count%",'<span class="post-count">&nbsp;</span>'),hideMany:commentingL10n.rpl_hide_2.replace("%name%",'<span class="poster-name"></span>').replace("%count%",'<span class="post-count">&nbsp;</span>'),moveForm:function(a,b){var e=jQuery("#"+a+" > .comment-body .comment-meta").next().text(),f=jQuery("#"+a+" > .comment-body cite.fn").text();return addComment.replying&&addComment.cancelReply(),addComment.replying=b,jQuery("#comment-form #comment").before(jQuery('<blockquote class="reply-quote"><cite>'+f+"</cite><p>"+(e.length>130?e.substring(0,129)+"&hellip;":e)+"</p></blockquote>").hide()).prev(".reply-quote").slideDown(),jQuery("#comment-form input#comment_parent").attr({value:b}),jQuery("#"+a+" > .comment-body ").find(".comment-reply-link").hide(),jQuery("#comment-form #cancel-comment-reply-link").show(),"function"==typeof jQuery.scrollTo&&jQuery.scrollTo("#respond",{duration:500,axis:"y",onAfter:function(){jQuery("#comment").focus()}}),!1},cancelReply:function(){0!==addComment.replying&&(addComment.replying=0,jQuery("#comment-form .reply-quote").slideUp(500,function(){jQuery(this).remove()}),jQuery("#comment-form input#comment_parent").attr({value:0}),jQuery("#comment-form #cancel-comment-reply-link").hide(),jQuery("#commentlist").find(".comment-reply-link").show()),jQuery("#comment-form .submit").removeAttr("disabled").removeClass("disabled"),addComment.startInterval(!0)},commentDepth:function(a){var b;return a?(b=jQuery("li#comment-"+a).attr("class").match(/\bdepth-(\d+)\b/i),void 0!==[1]&&parseInt(b[1],10)>0?parseInt(b[1],10):1):0},error:function(a){return"string"!=typeof a?!1:(jQuery("#comment-form .textarea-border").after(jQuery('<div class="error">'+a+"</div>").hide()).next(".error").slideDown("slow",function(){var a=jQuery(this);void 0!==jQuery(this)[0].style&&(jQuery(this).css("FILTER",""),jQuery(this)[0].style.filter=""),setTimeout(function(){jQuery(a).slideUp("slow",function(){jQuery(this).remove()})},5e3)}),!0)},deleteComment:function(a,b){var c=jQuery("ul#commentlist li#comment-"+a+", #trackback-list li#comment-"+a).length;return c?"unapprove"==b&&jQuery("ul#commentlist li#comment-"+a+" > .comment-body:has( .moderation )")?!0:(jQuery("li#comment-"+a+" > .comment-body").slideUp("slow",function(){jQuery(this).text("Deleted comment").slideDown().parent("li#comment-"+a).addClass("deleted")}),!0):!0},newComment:function(a,b,c,d,e){var g,f=jQuery("ul#commentlist li#comment-"+b+", #trackback-list li#comment-"+b).length;return f?(jQuery("ul#commentlist li#comment-"+b).find(".moderation").slideUp("slow",function(){jQuery(this).remove()}),jQuery("li#comment-"+b).hasClass("deleted")&&jQuery("li#comment-"+b+" > .comment-body").slideUp("slow",function(){jQuery(this).html(jQuery(a).find(".comment-body").html().trigger("newComment")).slideDown("slow")}).removeClass("deleted"),!0):("comment"==e&&c>0?jQuery("ul#commentlist li#comment-"+c).length&&(jQuery("ul#commentlist li#comment-"+c+" > ul.children").length||jQuery("ul#commentlist li#comment-"+c+" > div.comment-body").after('<ul class="children"></ul>'),jQuery("ul#commentlist li#comment-"+c+" > ul.children").append(jQuery(a).hide().addClass("rolledup").trigger("newComment")),g=jQuery("li#comment-"+c).attr("class").match(/(?:\s|^)depth-(\d+)\s?/i),null!==g[1]&&g[1].match(/\d+/)&&(jQuery("ul#commentlist li#comment-"+b).removeClass("depth-1 depth-2 depth-3 depth-4 depth-5 depth-6 depth-7 depth-8 depth-9 depth-10").addClass("depth-"+(parseInt(g[1],10)+1)),parseInt(g[1],10)+1>=commentingL10n.max_depth&&jQuery("ul#commentlist li#comment-"+b+" > div.comment-body .comment-reply-link").remove()),jQuery("#comment-"+b).closest("li:has(div.toggle)").children(".toggle").hasClass("hidden")&&jQuery("#comment-"+b).closest("li:has(div.toggle)").children(".toggle").removeClass("hidden").next("ul.children").slideDown("fast",function(){jQuery(this).prev("div.toggle").css({backgroundPosition:"bottom right"})}),addComment.toggleToggleText(jQuery("#comment-"+b).closest("li:has(div.toggle)").children(".toggle")),addComment.addToggles()):("comment"!==e&&jQuery("#trackback-list").length?jQuery("#trackback-list").append(jQuery(a).hide().addClass("rolledup").trigger("newComment")):"desc"===commentingL10n.order?jQuery("li#response-cont").after(jQuery(a).hide().addClass("rolledup").trigger("newComment")):jQuery("li#response-cont").before(jQuery(a).hide().addClass("rolledup").trigger("newComment")),addComment.addToggles()),d||(jQuery("#comment-"+b).addClass("new").children("#div-comment-"+b).find(".comment-meta").prepend('<span class="new-comment"></span>'),jQuery("#div-comment-"+b).bind("mouseover",function(){jQuery(this).find(".comment-meta span.new-comment").fadeTo(1e3,0,function(){jQuery(this).closest("li").removeClass("new"),jQuery(this).remove()})})),jQuery("ul#commentlist, ul#trackback-list").find(".rolledup").slideDown(500,function(){d&&jQuery.scrollTo("#comment-"+b,{duration:500,axis:"y"})}).removeClass("rolledup"),"comment"!==e&&addComment.trackbackToggle(400),!0)},submit:function(a){var b=!1;return jQuery(a).find(".vital").each(function(){var a=jQuery(this).attr("value");void 0===a||""===a?(b=!0,jQuery(this).addClass("oops"),setTimeout(function(){jQuery("#comment-form .vital").removeClass("oops")},6e3)):jQuery(this).removeClass("oops")}),b?(addComment.error(commentingL10n.err_txt_mis),!1):(addComment.startInterval(!1),jQuery(a).ajaxSubmit({beforeSubmit:function(){jQuery("#comment-form .submit").attr({disabled:"disabled"}).addClass("disabled")},type:"POST",data:{_spec_ajax:"Why are you looking at this POST data?",action:"new_comment_added",depth:addComment.commentDepth(addComment.replying)},error:function(a,b){var c;500===a.status?(c=jQuery(a.responseText).text().replace(/(\s+|\t|\r\n|\n|\r)+/g," "),(""===c||void 0===c)&&(c=a.status+" "+a.statusText),addComment.error(c)):"string"==typeof b?addComment.error(b):addComment.error("Oops!"),addComment.cancelReply()},success:function(a){var b;try{b=JSON.parse(a)}catch(c){return"string"==typeof a?addComment.error(a):addComment.error("Oops!"),addComment.cancelReply(),void 0}addComment.newComment(b.html,b.comment_ID,b.comment_parent,!0,"comment"),addComment.cancelReply(),jQuery("#comment-form #comment").val("").trigger("keyup")}}),!1)},addToggles:function(a){jQuery("#commentlist li.depth-"+commentingL10n.nest_depth+" > ul.children").each(function(){jQuery(this).prev("div.toggle").length||(jQuery(this).before(jQuery('<div class="toggle"></div>').hide().css({opacity:0})),jQuery(this).prev("div.toggle").show().fadeTo("slow",1,function(){void 0!==jQuery(this)[0].style&&(jQuery(this).css("FILTER",""),jQuery(this)[0].style.filter="")})),a===!0&&jQuery(this).hide().prev("div.toggle").addClass("kqofn-hidden"),addComment.toggleToggleText(jQuery(this).prev("div.toggle"))})},toggleToggleText:function(a){return"object"!=typeof a&&"string"==typeof a&&(a=jQuery(a)),a.each(function(){var a=jQuery(this).prev("div.comment-body").find("cite.fn").text(),b=jQuery(this).next("ul.children").find("li.comment").length;jQuery(this).hasClass("kqofn-hidden")?jQuery(this).html(1==b?addComment.showOne:addComment.showMany):jQuery(this).html(1==b?addComment.hideOne:addComment.hideMany),jQuery(this).find(".post-count").text(b),jQuery(this).find(".poster-name").text(""!=a?a:commentingL10n.unknown)}),!0},startInterval:function(a){a===!0?void 0!==commentingL10n.update&&1==commentingL10n.update&&(addComment.interval=setInterval(function(){addComment.getUpdates()},parseInt(commentingL10n.polling,10)>=10?1e3*commentingL10n.polling:1e4)):clearInterval(addComment.interval)},getUpdates:function(){addComment.getCommentUpdates()},getCommentUpdates:function(){var a={_spec_ajax:"Why is everyone looking at me",action:"get_comment_changes",action_id:addComment.action_id,time:commentingL10n.time,post_id:commentingL10n.post_id};jQuery.post(commentingL10n.ajax_url,a,function(a){var b,c;try{b=JSON.parse(a)}catch(d){return"string"==typeof a?addComment.error(a):addComment.error("Oops!"),void 0}if(null!==b&&void 0!==b)for(c in b)if(comment=b[c],void 0!==comment){var e=null!==comment.log_date?comment.log_date:comment.comment_date;null!==e&&(commentingL10n.time=e),addComment.action_id=null!==comment.action_id?comment.action_id:0,void 0!==comment.html&&null!==b[c].html&&""!==comment.html?addComment.newComment(comment.html,comment.comment_ID,comment.comment_parent,!1,comment.comment_type):addComment.deleteComment(comment.comment_ID,comment.action)}})},getModerationUpdates:function(){var a={_spec_ajax:"Why is everyone looking at me",action:"get_moderation_changes",action_id:addComment.action_id,time:commentingL10n.time,post_id:commentingL10n.post_id};jQuery.post(commentingL10n.ajax_url,a,function(a){var b,c,d;try{b=JSON.parse(a)}catch(e){return"string"==typeof a?addComment.error(a):addComment.error("Oops!"),void 0}if(null!==b&&void 0!==b)for(c in b)if(d=b[c],void 0!==d){var f=null!==d.log_date?d.log_date:d.comment_date;null!==f&&(commentingL10n.time=f),addComment.action_id=null!==d.action_id?d.action_id:0,void 0!==d.html&&null!==d.html&&""!==d.html&&addComment.newComment(d.html,d.comment_ID,d.comment_parent,!1,d.comment_type)}})},trackbackToggle:function(a){jQuery("#trackback-list").height()>(a>0?a:400)&&!jQuery("#trackback-list").prev(".trackback-toggle").length&&jQuery("#trackback-list").length&&jQuery("#trackback-list").hide().before('<div class="trackback-toggle"><span class="toggle-text">'+commentingL10n.tb_show+"</span></div>").prev(".trackback-toggle").click(function(){jQuery(this).toggleClass("active").next("#trackback-list").slideToggle("fast",function(){jQuery(this).prev(".trackback-toggle").children(".toggle-text").text("none"===jQuery(this).css("display")?commentingL10n.tb_show:commentingL10n.tb_hide)})}),jQuery("#commentlist li.pingback > .comment-body .comment-content, #commentlist li.trackback > .comment-body .comment-content").each(function(){if(jQuery(this).prev(".trackback-toggle").length)return!0;var a=commentingL10n.tb_from.replace("%s",'<span class="tb-from">'+jQuery(this).find("cite.fn").text()+"</span>");return jQuery(this).hide().addClass("with-toggle").before('<div class="trackback-toggle"></div>').prev(".trackback-toggle").html(a).click(function(){jQuery(this).next(".comment-content").slideToggle("fast")}),!0})},approveComment:function(a,b){var c={_spec_ajax:"Why is everyone looking at me",action:"approve_comment",action_id:addComment.action_id,time:commentingL10n.time,post_id:commentingL10n.post_id,comment_id:b};jQuery.post(commentingL10n.ajax_url,c,function(b){"done"==b?(a.text("Approval sent, verifying..."),addComment.getCommentUpdates()):addComment.error(b)})},spamComment:function(a,b){var c={_spec_ajax:"Why is everyone looking at me",action:"spam_comment",action_id:addComment.action_id,time:commentingL10n.time,post_id:commentingL10n.post_id,comment_id:b};jQuery.post(commentingL10n.ajax_url,c,function(b){"done"==b?(a.text("Spam req sent, verifying..."),addComment.getCommentUpdates()):addComment.error(b)})},trashComment:function(a,b){var c={_spec_ajax:"Why is everyone looking at me",action:"delete_comment",action_id:addComment.action_id,time:commentingL10n.time,post_id:commentingL10n.post_id,comment_id:b};jQuery.post(commentingL10n.ajax_url,c,function(b){"done"==b?(a.text("Deletion sent, verifying..."),addComment.getCommentUpdates()):addComment.error(b)})},_init:function(){jQuery(document).ready(function(a){addComment.startInterval(!0),a.ajaxSetup({cache:!1,timeout:1e3*commentingL10n.polling-2e3}),a("form#comment-form").submit(function(){return addComment.submit(this),!1}),a("#cancel-comment-reply-link").on("click",function(){return addComment.cancelReply(),!1}),a(".spec_moderation_button_approve").on("click",function(){var b=a(this).attr("data-comment");return addComment.approveComment(a(this),b),!1}),a(".spec_moderation_button_spam").on("click",function(){var b=a(this).attr("data-comment");return addComment.spamComment(a(this),b),!1}),a(".spec_moderation_button_delete").on("click",function(){var b=a(this).attr("data-comment");return addComment.trashComment(a(this),b),!1}),addComment.addToggles(!0),a("#commentlist div.toggle").on("click",function(){a(this).hasClass("kqofn-hidden")?a(this).removeClass("kqofn-hidden").next("ul.children").slideDown("fast",function(){a(this).prev("div.toggle").css({backgroundPosition:"bottom right"})}):a(this).addClass("kqofn-hidden").next("ul.children").slideUp("fast",function(){a(this).prev("div.toggle").css({backgroundPosition:"top left"})}),addComment.toggleToggleText(jQuery(this))}),addComment.trackbackToggle(400),a("#commentlist .comment-link").on("click",function(){var b=a(this).attr("href"),c=a(this).text(),d=a('<div class="comment-link-display"><span>'+c+'</span><input type="text" value="'+b+'" /></div>');return a("body").append(d).find(".comment-link-display").css({position:"absolute",top:a(this).offset().top-27+"px",left:a(this).offset().left+5+"px",zIndex:100,opacity:0}).fadeTo("fast",1,function(){a(this).find("input").blur(function(){a(this).parents(".comment-link-display").fadeTo("fast",0,function(){a(this).remove()})}),a(this).find("input").focus()}),!1}),a(".comment-link-display input").on("focus",function(){this.select()}),a.each(a.browser,function(b,c){if("msie"==b&&c===!0)switch(parseInt(a.browser.version.substr(0,1),10)){case 6:case 7:for($target=a("#comment");"inherit"==$target.css("fontFamily");)$target=$target.parent();a("#comment").css({fontFamily:$target.css("fontFamily"),fontSize:$target.css("fontSize"),width:a("#comment").innerWidth()})}}),a("#comment").autogrow()})}},addComment._init();