addComment={replying:0,showOne:commentingL10n.replyShowOne.replace("%name%",'<span class="poster-name"></span>').replace("%count%",'<span class="post-count">&nbsp;</span>'),hideOne:commentingL10n.replyHideOne.replace("%name%",'<span class="poster-name"></span>').replace("%count%",'<span class="post-count">&nbsp;</span>'),showMany:commentingL10n.replyShowMany.replace("%name%",'<span class="poster-name"></span>').replace("%count%",'<span class="post-count">&nbsp;</span>'),hideMany:commentingL10n.replyHideMany.replace("%name%",'<span class="poster-name"></span>').replace("%count%",'<span class="post-count">&nbsp;</span>'),moveForm:function(c,b,f,a){var g=jQuery("#"+c+" > .comment-body .comment-meta").next().text(),h=jQuery("#"+c+" > .comment-body cite.fn").text();if(addComment.replying){addComment.cancelReply()}addComment.replying=b;jQuery("#comment-form #comment").before('<blockquote class="reply-quote"><cite>'+h+"</cite><p>"+(g.length>130?g.substring(0,129)+"&hellip;":g)+"</p></blockquote>");jQuery("#comment-form input#comment_parent").attr({value:b});jQuery("#"+c+" > .comment-body ").find(".comment-reply-link").hide();jQuery("#comment-form #cancel-comment-reply-link").show();try{jQuery.scrollTo(jQuery("#respond"),{duration:500})}catch(d){}return false},cancelReply:function(){if(addComment.replying!==0){addComment.replying=0;jQuery("#comment-form .reply-quote").remove();jQuery("#comment-form input#comment_parent").attr({value:0});jQuery("#comment-form #cancel-comment-reply-link").hide();jQuery("#commentlist").find(".comment-reply-link").show()}jQuery("#comment-form .submit").attr({disabled:""}).removeClass("disabled")},commentDepth:function(b){var a;if(b){a=jQuery("li#comment-"+b).attr("class").match(/\bdepth-(\d+)\b/i);return[1]!==undefined&&parseInt(a[1],10)>0?parseInt(a[1],10):1}else{return 0}},error:function(a){if(typeof a!=="string"){return false}jQuery("#comment-form .textarea-border").after(jQuery('<div class="error">'+a+"</div>").hide()).next(".error").slideDown("slow",function(){var b=jQuery(this);jQuery(this).css("FILTER","");jQuery(this)[0].style.filter="";setTimeout(function(){jQuery(b).slideUp("slow",function(){jQuery(this).remove()})},5000)});return true},submit:function(b){var a=false;jQuery(b).find(".vital").each(function(){var c=jQuery(this).attr("value");if(c===undefined||c===""){a=true;jQuery(this).css({borderColor:"#f00"}).fadeOut(250).fadeIn(250);setTimeout(function(){jQuery("#comment-form .vital").css({borderColor:"#ccc"})},10000)}else{jQuery(this).css({borderColor:"#ccc"})}});if(a){addComment.error("Missing some fields");return false}jQuery(b).ajaxSubmit({beforeSubmit:function(c){jQuery("#comment-form .submit").attr({disabled:"disabled"}).addClass("disabled")},type:"POST",data:{_spec_ajax:"Why are you looking at this POST data?",action:"new_comment_added",depth:addComment.commentDepth(addComment.replying)},error:function(c,d){var f;if(c.status===500){f=jQuery(c.responseText).text().replace(/(\s+|\t|\r\n|\n|\r)+/g," ");if(f===""||f===undefined){f=c.status+" "+c.statusText}addComment.error(f)}else{if(typeof d==="string"){addComment.error(d)}else{addComment.error("Oops!")}}addComment.cancelReply()},success:function(c){var g;try{g=JSON.parse(c)}catch(f){if(typeof c==="string"){addComment.error(c)}else{addComment.error("Oops!")}addComment.cancelReply();return}if(addComment.replying){if(!jQuery("ul#commentlist li#comment-"+addComment.replying+" > ul.children").length){jQuery("ul#commentlist li#comment-"+addComment.replying+" > div.comment-body").after('<ul class="children"></ul>')}jQuery("ul#commentlist li#comment-"+addComment.replying+" > ul.children").append(jQuery(g.html).hide().addClass("rolledup"))}else{if(commentingL10n.order==="desc"){jQuery("li#respond").after(jQuery(g.html).hide().addClass("rolledup"))}else{jQuery("li#respond").before(jQuery(g.html).hide().addClass("rolledup"))}}addComment.cancelReply();addComment.addToggles();jQuery("#comment-form #comment").val("");jQuery("ul#commentlist").find(".rolledup").slideDown().removeClass("rolledup");if(typeof jQuery.scrollTo=="function"&&g.comment_ID>0){jQuery.scrollTo(jQuery("#comment-"+g.comment_ID),{duration:500})}}});return false},addToggles:function(a){jQuery("#commentlist li.depth-"+commentingL10n.nestDepth+" > ul.children").each(function(){if(!jQuery(this).prev("div.toggle").length){jQuery(this).before(jQuery('<div class="toggle"></div>').hide().css({opacity:0}));jQuery(this).prev("div.toggle").show().fadeTo("slow",1,function(){jQuery(this).css("FILTER","");jQuery(this)[0].style.filter=""})}if(a===true){jQuery(this).hide().prev("div.toggle").addClass("hidden")}addComment.toggleToggleText(jQuery(this).prev("div.toggle"))})},toggleToggleText:function(a){if(typeof a!=="object"&&typeof a==="string"){a=jQuery(a)}a.each(function(){var c=jQuery(this).prev("div.comment-body").find("cite.fn").text(),b=jQuery(this).next("ul.children").find("li.comment").length;if(jQuery(this).hasClass("hidden")){jQuery(this).html(b==1?addComment.showOne:addComment.showMany)}else{jQuery(this).html(b==1?addComment.hideOne:addComment.hideMany)}jQuery(this).find(".post-count").text(b);jQuery(this).find(".poster-name").text(c)});return true},_init:function(){jQuery(document).ready(function(a){a("#comment-form").live("submit",function(){addComment.submit(this);return false});a("#cancel-comment-reply-link").live("click",function(){addComment.cancelReply();return false});addComment.addToggles(true);a("#commentlist div.toggle").live("click",function(){if(a(this).hasClass("hidden")){a(this).removeClass("hidden").next("ul.children").slideDown("fast",function(){a(this).prev("div.toggle").css({backgroundPosition:"bottom right"})})}else{a(this).addClass("hidden").next("ul.children").slideUp("fast",function(){a(this).prev("div.toggle").css({backgroundPosition:"top left"})})}addComment.toggleToggleText(jQuery(this))});if(a("#trackback-list").height()>400){a("#trackback-list").hide().before('<div class="trackback-toggle"><span class="toggle-text">'+commentingL10n.trackbackShowText+"</span></div>").prev(".trackback-toggle").click(function(){a(this).toggleClass("active").next("#trackback-list").slideToggle("fast",function(){a(this).prev(".trackback-toggle").children(".toggle-text").text(a(this).css("display")==="none"?commentingL10n.trackbackShowText:commentingL10n.trackbackHideText)})})}a("#commentlist li.pingback > .comment-body, #commentlist li.trackback > .comment-body").each(function(){var b="Trackback from %s".replace("%s",a(this).find("cite.fn").text());a(this).hide().before('<div class="trackback-toggle"></div>').prev(".trackback-toggle").text(b).click(function(){a(this).next(".comment-body").slideToggle("fast")})})})}};addComment._init();