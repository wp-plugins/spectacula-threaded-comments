jQuery(document).ready(function(a){function b(){var a;return window.getSelection?a=window.getSelection():document.getSelection?a=document.getSelection():document.selection&&(a=document.selection.createRange().text),""!=a.toString()?a.toString():!1}function c(a){return null!=a.id&&("quote-float"===a.id||c(a.parentNode))}function d(b){a(b).children(".comment-body").find(".comment-buttons").append(a('<a href="#" class="comment-button">'+specQuoteLn.button_text+"</a>").click(function(){return e(this),!1}))}function e(b){var c=a(b).parents(".comment-buttons").prev(".comment-text").html(),d=a(b).parents(".comment-buttons").siblings(".comment-meta").find("cite.fn").text(),e="";e='<blockquote cite="'+a.trim(d)+'">\n<cite>'+a.trim(d)+"</cite>\n"+a.trim(c)+"\n</blockquote>\n",g("comment",e)}function f(a){a.focus();var b=document.selection.createRange(),c=a.createTextRange(),d=c.duplicate();return c.moveToBookmark(b.getBookmark()),d.setEndPoint("EndToStart",c),null==b?0:d.text.length}function g(b,c){var d=document.getElementById(b),e=d.value,g=void 0!==d.selectionStart?d.selectionStart:f(d);a("#"+b).val(e.substring(0,g)+c+e.substring(g,e.length)).trigger("keyup"),a.scrollTo("#"+b,{duration:500,axis:"y",onAfter:function(){jQuery("#"+b).focus()}})}specQuoteLn.quote_button&&a(".comment").each(function(){d(this)}).on("newComment",function(){d(this)}),specQuoteLn.quote_select&&(a(specQuoteLn.quote_target).mouseup(function(c){var d=b(),e=a(c.currentTarget),f=c.pageY,h=c.pageX,i=e.offset().left+e.width();d&&a("<div><span>"+specQuoteLn.button_text+"</span></div>").attr({id:"quote-float"}).appendTo("body").css({position:"absolute",left:h+1,top:f-a("#quote-float").height()/2,zIndex:1e3}).animate({left:i+10},500).click(function(){g("comment","<blockquote>\n"+a.trim(d)+"\n</blockquote>\n"),a("#quote-float").remove()})}),a(document).mousedown(function(b){var d=b.target||window.event.srcElement;c(d)||a("#quote-float").remove()}))});